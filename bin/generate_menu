#!/usr/bin/env ruby
# frozen_string_literal: true

require 'optparse'
require 'bundler/setup'
require 'ruby_md_ssg'

RubyMdSsg::Paths.reset!
RubyMdSsg::Paths.root = Dir.pwd

options = {
  docs: RubyMdSsg::Paths.docs_dir,
  menu: RubyMdSsg::Paths.menu_config
}

OptionParser.new do |parser|
  parser.banner = 'Usage: bin/generate_menu [options]'
  parser.on('--docs PATH', 'Directory containing markdown docs') { |path| options[:docs] = File.expand_path(path) }
  parser.on('--menu PATH', 'Menu YAML output path') { |path| options[:menu] = File.expand_path(path) }
end.parse!

generator = RubyMdSsg::MenuGenerator.new(docs_dir: options[:docs], menu_path: options[:menu])
output = generator.generate

puts "Menu configuration written to #{output}"
